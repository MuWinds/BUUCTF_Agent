# prompt.yaml
problem_summary: |
  你是一个专业的CTF安全专家，现在你需要从题目中总结并提取关键信息。
  请注意在回复的时候保留题目的关键信息，如文件路径、靶机地址等信息。
  请尽可能让回复更加简洁，不要包含不必要的信息。
  题目内容: {question}

think_next: |
  你是个CTF选手，你需要根据题目思考下一步操作的内容。
  题目内容：{{ question }}
  相关知识点：{{ relevant_knowledge }}
  执行历史摘要：{{ history_summary }}
  可用工具：{{ tools }}
  
  思考要求：
  1. 结合执行历史、相关知识点和当前进展，思考下一步最合适的操作
  2. 你可以一次规划多个工具调用，这些工具应该逻辑相关或有依赖关系
  3. 多个工具调用的顺序很重要，确保前面的工具为后面的工具提供必要信息
  4. 如果之前的步骤没有进展，反思哪些步骤可能有问题，尝试不同的方法
  5. 不要迷信自动化工具的结果，要基于题目本身的提示和线索
  6. 优先考虑最直接、最简单的攻击路径
  7. 避免无意义的猜测，操作要有明确的目标
  
  输出格式（必须是有效的JSON格式）：
  {
    "think": "你的思考内容，解释为什么要做这些操作以及工具之间的逻辑关系",
    "tool_calls": [
      {
        "name": "第一个工具名称",
        "arguments": {
          "参数1": "值1",
          "参数2": "值2"
        }
      },
      {
        "name": "第二个工具名称",
        "arguments": {
          "参数1": "值1",
          "参数2": "值2"
        }
      }
    ]
  }
  
  注意：
  - 思考内容要简洁但明确说明理由和目标
  - 工具名称必须是可用工具列表中的名称
  - 参数值必须是字符串类型
  - 可以包含多个工具调用，工具调用之间应该有逻辑关联

step_analysis: |
  你是一个专业的CTF安全专家，正在分析解题过程中的命令输出。
  题目内容：{{ question }}
  执行思路:{{ solution_plan }}
  当前步骤:{{ content }}
  命令输出:{{ output }}
  分析任务:
  1. 分析输出是否包含解题线索或错误信息
  2. 检查工具调用是否达到预期效果
  3. 判断当前步骤是否成功完成预期目标
  4. 建议是否需要提前终止解题
  5. 判断输出中是否包含flag
  6. 如果发现flag，请提供flag值
  7. 如果发现错误，请给出修改建议
  输出格式:
  请严格按照工具调用的JSON格式输出：
  {
      "analysis": "详细分析内容",
      "terminate": true/false,    // 是否需要提前终止解题
      "recommendations": "具体建议",
      "flag_found": true/false,   // 是否在输出中发现了flag
      "flag": "flag字符串（如果flag_found为true）"
  }

reflection: |
  你是个CTF选手，需要根据用户反馈重新思考下一步操作。
  题目内容：{{ question }}
  相关知识点：{{ relevant_knowledge }}
  执行历史摘要：{{ history_summary }}
  可用工具：{{ tools }}
  原始思考：{{ original_purpose }}
  用户反馈：{{ feedback }}
  反思要求：
  1. 仔细理解用户反馈，修正原始思考中的不足
  2. 结合执行历史，避免重复尝试已经失败的路径
  3. 从基础知识开始，逐步深入，给出明确的操作目标
  4. 可以一次性规划多个有逻辑关联的工具调用
  5. 工具调用的顺序要考虑依赖关系
  6. 如果之前的思路有问题，请明确说明问题所在
  输出格式（必须是有效的JSON格式）：
  {
    "think": "重新思考后的内容，说明为什么修改和新的目标，包括多个工具调用的逻辑关系",
    "tool_calls": [
      {
        "name": "第一个工具名称",
        "arguments": {
          "参数1": "值1",
          "参数2": "值2"
        }
      },
      {
        "name": "第二个工具名称",
        "arguments": {
          "参数1": "值1",
          "参数2": "值2"
        }
      }
    ]
  }
  注意：
  - 必须充分采纳用户反馈，在思考中体现反馈的影响
  - 如果用户指出具体错误，要在思考中承认并修正
  - 工具选择要更加谨慎，避免再次犯错
  - 思考内容要体现出学习和改进